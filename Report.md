# Отчёт по лабораторной работе «RPC. gRPC. Protobuf»

**Предмет**: _Проектирование и развертывание веб-решений в экосистеме Python_

**Студент**: _Безкоровайный Павел Валерьевич_

## Ход работы

### Шаг 1. Подготовка проекта

Был создан репозиторий в github и склонирован на локальную машину.
Внутри папки проекта были выполнены следующие команды для создания окружения и установки зависимостей

```shell
# создание виртуального окружения
python -m venv venv

# активация виртуального окружения
venv/Scripts/Activate.ps1

# установка зависимостей
pip install grpcio grpcio-tools

# фиксация зависимостей в файл
pip freeze > requirements.txt

# команда для отключения виртуального окружения
# deactivate
```

### Шаг 2. Определение контракта в .proto файле

В файле `glossary.proto` были определены структуры данных, которыми будут обмениваться клиент и сервер,
а также сервис с методами.

### Шаг 3. Генерация Python-кода

С помощью команды ниже были сгенерированы следующие python-файлы:

- классы сообщений (`glossary_pb2.py`),
- классы для сервера и клиента (`glossary_pb2_grpc.py`),
- файлы `.pyi` для улучшения автодополнения в IDE

```shell
python -m grpc_tools.protoc `
	-I=src/protos `
	--python_out=src/generated `
	--pyi_out=src/generated `
	--grpc_python_out=src/generated `
	src/protos/glossary.proto
```

> Note: в сгенерированном файле `glossary_pb2_grpc.py` необходимо изменить строчку `import glossary_pb2 as glossary__pb2` на `from . import glossary_pb2 as glossary__pb2`

### Шаг 4. Написание кода

В папке src были добавлены следующие файлы:

- `__init__.py` - файл для обозначения, что директория является пакетом,
- `database.py` - скрипт для работы с SQLite,
- `server.py` - скрипт gRPC-сервера,
- `client.py` - скрипт клиента для тестирования API сервера.

### Шаг 5. Запуск

Для запуска сервера используется команда: `python src/server.py`.

Для запуска клиента используется команда: `python src/client.py`.

> Note: оба терминала должны предварительно активировать виртуальное окружение (venv)
